<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Merge Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classMerge-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Merge Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for merging low-level Varnodes into high-level HighVariables.  
 <a href="classMerge.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="merge_8hh_source.html">merge.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad96bd04ca6c3bd22347ef0cf01f027c2"><td class="memItemLeft" align="right" valign="top"><a id="ad96bd04ca6c3bd22347ef0cf01f027c2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#ad96bd04ca6c3bd22347ef0cf01f027c2">Merge</a> (<a class="el" href="classFuncdata.html">Funcdata</a> &amp;fd)</td></tr>
<tr class="memdesc:ad96bd04ca6c3bd22347ef0cf01f027c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct given a specific function. <br /></td></tr>
<tr class="separator:ad96bd04ca6c3bd22347ef0cf01f027c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc0c74b3892b9724fd4091a126631089"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#abc0c74b3892b9724fd4091a126631089">intersection</a> (<a class="el" href="classHighVariable.html">HighVariable</a> *a, <a class="el" href="classHighVariable.html">HighVariable</a> *b)</td></tr>
<tr class="memdesc:abc0c74b3892b9724fd4091a126631089"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the intersection of two HighVariables and cache the result.  <a href="#abc0c74b3892b9724fd4091a126631089">More...</a><br /></td></tr>
<tr class="separator:abc0c74b3892b9724fd4091a126631089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682cf4cedcb80161fa47a1f0c7382a77"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a682cf4cedcb80161fa47a1f0c7382a77">inflateTest</a> (<a class="el" href="classVarnode.html">Varnode</a> *a, <a class="el" href="classHighVariable.html">HighVariable</a> *high)</td></tr>
<tr class="memdesc:a682cf4cedcb80161fa47a1f0c7382a77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if we can inflate the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> of the given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> without incurring intersections.  <a href="#a682cf4cedcb80161fa47a1f0c7382a77">More...</a><br /></td></tr>
<tr class="separator:a682cf4cedcb80161fa47a1f0c7382a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a157b6a6d44e6aec22f1bb77201f3e402"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a157b6a6d44e6aec22f1bb77201f3e402">inflate</a> (<a class="el" href="classVarnode.html">Varnode</a> *a, <a class="el" href="classHighVariable.html">HighVariable</a> *high)</td></tr>
<tr class="memdesc:a157b6a6d44e6aec22f1bb77201f3e402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inflate the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> of a given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> with a <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>.  <a href="#a157b6a6d44e6aec22f1bb77201f3e402">More...</a><br /></td></tr>
<tr class="separator:a157b6a6d44e6aec22f1bb77201f3e402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3433895878fb4851a8e06899b87f41"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#ace3433895878fb4851a8e06899b87f41">mergeTest</a> (<a class="el" href="classHighVariable.html">HighVariable</a> *high, vector&lt; <a class="el" href="classHighVariable.html">HighVariable</a> *&gt; &amp;tmplist)</td></tr>
<tr class="memdesc:ace3433895878fb4851a8e06899b87f41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test for intersections between a given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> and a list of other HighVariables.  <a href="#ace3433895878fb4851a8e06899b87f41">More...</a><br /></td></tr>
<tr class="separator:ace3433895878fb4851a8e06899b87f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55762a93af96a7e8abab70b169302b59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a55762a93af96a7e8abab70b169302b59">mergeOpcode</a> (<a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7">OpCode</a> opc)</td></tr>
<tr class="memdesc:a55762a93af96a7e8abab70b169302b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to force merges of input to output for all p-code ops of a given type.  <a href="#a55762a93af96a7e8abab70b169302b59">More...</a><br /></td></tr>
<tr class="separator:a55762a93af96a7e8abab70b169302b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a319ac2d65a6dff86cbfda772d047b2e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a319ac2d65a6dff86cbfda772d047b2e1">mergeByDatatype</a> (VarnodeLocSet::const_iterator startiter, VarnodeLocSet::const_iterator enditer)</td></tr>
<tr class="memdesc:a319ac2d65a6dff86cbfda772d047b2e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to merge all HighVariables in the given range that have the same data-type.  <a href="#a319ac2d65a6dff86cbfda772d047b2e1">More...</a><br /></td></tr>
<tr class="separator:a319ac2d65a6dff86cbfda772d047b2e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8045c24ce73080b02d4506f2047a414e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a8045c24ce73080b02d4506f2047a414e">mergeAddrTied</a> (void)</td></tr>
<tr class="memdesc:a8045c24ce73080b02d4506f2047a414e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force the merge of <em>address</em> <em>tried</em> Varnodes.  <a href="#a8045c24ce73080b02d4506f2047a414e">More...</a><br /></td></tr>
<tr class="separator:a8045c24ce73080b02d4506f2047a414e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedcf63d8d5400410d06ef4aa250275a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#aedcf63d8d5400410d06ef4aa250275a1">mergeMarker</a> (void)</td></tr>
<tr class="memdesc:aedcf63d8d5400410d06ef4aa250275a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force the merge of input and output Varnodes to MULTIEQUAL and INDIRECT ops.  <a href="#aedcf63d8d5400410d06ef4aa250275a1">More...</a><br /></td></tr>
<tr class="separator:aedcf63d8d5400410d06ef4aa250275a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79f377000da91c9e50b89307fa88d268"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a79f377000da91c9e50b89307fa88d268">mergeAdjacent</a> (void)</td></tr>
<tr class="memdesc:a79f377000da91c9e50b89307fa88d268"><td class="mdescLeft">&#160;</td><td class="mdescRight">Speculatively merge Varnodes that are input/output to the same p-code op.  <a href="#a79f377000da91c9e50b89307fa88d268">More...</a><br /></td></tr>
<tr class="separator:a79f377000da91c9e50b89307fa88d268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07666baf4d4fb03ee2243d22f15c25d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#ab07666baf4d4fb03ee2243d22f15c25d">mergeMultiEntry</a> (void)</td></tr>
<tr class="memdesc:ab07666baf4d4fb03ee2243d22f15c25d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classMerge.html" title="Class for merging low-level Varnodes into high-level HighVariables. ">Merge</a> together Varnodes mapped to SymbolEntrys from the same <a class="el" href="classSymbol.html" title="The base class for a symbol in a symbol table or scope. ">Symbol</a>.  <a href="#ab07666baf4d4fb03ee2243d22f15c25d">More...</a><br /></td></tr>
<tr class="separator:ab07666baf4d4fb03ee2243d22f15c25d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1f01b80297db3a5c37c9860af56162"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#abb1f01b80297db3a5c37c9860af56162">hideShadows</a> (<a class="el" href="classHighVariable.html">HighVariable</a> *high)</td></tr>
<tr class="memdesc:abb1f01b80297db3a5c37c9860af56162"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hide <em>shadow</em> Varnodes related to the given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> by consolidating COPY chains.  <a href="#abb1f01b80297db3a5c37c9860af56162">More...</a><br /></td></tr>
<tr class="separator:abb1f01b80297db3a5c37c9860af56162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af9c332a00eee4f51242239e05bc916"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a0af9c332a00eee4f51242239e05bc916">processCopyTrims</a> (void)</td></tr>
<tr class="memdesc:a0af9c332a00eee4f51242239e05bc916"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to reduce/eliminate COPYs produced by the merge trimming process.  <a href="#a0af9c332a00eee4f51242239e05bc916">More...</a><br /></td></tr>
<tr class="separator:a0af9c332a00eee4f51242239e05bc916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f49b387659a09e702cb70cacb050ec1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMerge.html#a6f49b387659a09e702cb70cacb050ec1">markInternalCopies</a> (void)</td></tr>
<tr class="memdesc:a6f49b387659a09e702cb70cacb050ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark redundant/internal COPY PcodeOps.  <a href="#a6f49b387659a09e702cb70cacb050ec1">More...</a><br /></td></tr>
<tr class="separator:a6f49b387659a09e702cb70cacb050ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class for merging low-level Varnodes into high-level HighVariables. </p>
<p>As a node in Single Static Assignment (SSA) form, a <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> has at most one defining operation. To get a suitable notion of a single high-level variable (<a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>) that may be reassigned at multiple places in a single function, individual <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> objects can be <em>merged</em> into a <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> object. <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> objects may be merged in this way if there is no pairwise intersection between each <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a>'s <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a>, the ranges of code where the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> holds its value.</p>
<p>For a given function, this class attempts to merge Varnodes using various strategies and keeps track of <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersections to facilitate the process. <a class="el" href="classMerge.html" title="Class for merging low-level Varnodes into high-level HighVariables. ">Merge</a> strategies break up into two general categories: <b>forced</b> merges, and <b>speculative</b> merges. Forced merges <em>must</em> happen, and extra Varnodes may be added to split up problematic covers to enforce it. Forced merges include:</p><ul>
<li>Merging inputs and outputs of MULTIEQUAL and INDIRECT operations</li>
<li>Merging Varnodes at global (persistent) storage locations</li>
<li>Merging Varnodes at mapped stack locations</li>
</ul>
<p>Speculative merges are attempted to reduce the overall number of variables defined by a function, but any given merge attempt is abandoned if there are <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersections. No modification is made to the data-flow to force the merge. Speculative merges include:</p><ul>
<li>Merging an input and output <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> of a single p-code op</li>
<li>Merging Varnodes that hold the same data-type </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="abb1f01b80297db3a5c37c9860af56162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb1f01b80297db3a5c37c9860af56162">&#9670;&nbsp;</a></span>hideShadows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Merge::hideShadows </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classHighVariable.html">HighVariable</a> *&#160;</td>
          <td class="paramname"><em>high</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hide <em>shadow</em> Varnodes related to the given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> by consolidating COPY chains. </p>
<p>If two Varnodes are copied from the same common ancestor then they will always contain the same value and can be considered <b>shadows</b> of the same variable. If the paths from the ancestor to the two Varnodes aren't properly nested, the two Varnodes will still look like distinct variables. This routine searches for this situation, relative to a single <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>, and alters data-flow so that copying from ancestor to first <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> to second <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> becomes a single path. Both Varnodes then ultimately become instances of the same <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">high</td><td>is the given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> to search near </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if a change was made to data-flow </dd></dl>

</div>
</div>
<a id="a157b6a6d44e6aec22f1bb77201f3e402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a157b6a6d44e6aec22f1bb77201f3e402">&#9670;&nbsp;</a></span>inflate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::inflate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVarnode.html">Varnode</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classHighVariable.html">HighVariable</a> *&#160;</td>
          <td class="paramname"><em>high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inflate the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> of a given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> with a <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>. </p>
<p>An expression involving a <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> can be propagated to all the read sites of the output <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> of the expression if the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> can be <b>inflated</b> to include the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> of the <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>, even though the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> is not part of the <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>. This routine performs the inflation, assuming an intersection test is already performed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>is the given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> to inflate </td></tr>
    <tr><td class="paramname">high</td><td>is the <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> to inflate with </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a682cf4cedcb80161fa47a1f0c7382a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a682cf4cedcb80161fa47a1f0c7382a77">&#9670;&nbsp;</a></span>inflateTest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Merge::inflateTest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVarnode.html">Varnode</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classHighVariable.html">HighVariable</a> *&#160;</td>
          <td class="paramname"><em>high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test if we can inflate the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> of the given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> without incurring intersections. </p>
<p>This routine tests whether an expression involving a <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> can be propagated to all the read sites of the output <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> of the expression. This is possible only if the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> can be <b>inflated</b> to include the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> of the <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>, even though the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> is not part of the <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>is the given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> to inflate </td></tr>
    <tr><td class="paramname">high</td><td>is the <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> being propagated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> can be inflated without intersection </dd></dl>

</div>
</div>
<a id="abc0c74b3892b9724fd4091a126631089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc0c74b3892b9724fd4091a126631089">&#9670;&nbsp;</a></span>intersection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Merge::intersection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classHighVariable.html">HighVariable</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classHighVariable.html">HighVariable</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the intersection of two HighVariables and cache the result. </p>
<p>If the Covers of the two variables intersect, this routine returns <b>true</b>. To avoid expensive computation on the <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> objects themselves, the test result associated with the pair of HighVariables is cached. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>is the first <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> </td></tr>
    <tr><td class="paramname">b</td><td>is the second <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if the variables intersect </dd></dl>

</div>
</div>
<a id="a6f49b387659a09e702cb70cacb050ec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f49b387659a09e702cb70cacb050ec1">&#9670;&nbsp;</a></span>markInternalCopies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::markInternalCopies </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mark redundant/internal COPY PcodeOps. </p>
<p>Run through all COPY, SUBPIECE, and PIECE operations (PcodeOps that copy data) and characterize those that are <em>internal</em> (copy data between storage locations representing the same variable) or <em>redundant</em> (perform the same copy as an earlier operation). These, as a result, are not printed in the final source code representation. </p>

</div>
</div>
<a id="a8045c24ce73080b02d4506f2047a414e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8045c24ce73080b02d4506f2047a414e">&#9670;&nbsp;</a></span>mergeAddrTied()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::mergeAddrTied </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force the merge of <em>address</em> <em>tried</em> Varnodes. </p>
<p>For each set of address tied Varnodes with the same size and storage address, merge them into a single <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>. The merges are <em>forced</em>, so any <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersections must be resolved by altering data-flow, which involves inserting additional COPY ops and <em>unique</em> Varnodes. </p>

</div>
</div>
<a id="a79f377000da91c9e50b89307fa88d268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79f377000da91c9e50b89307fa88d268">&#9670;&nbsp;</a></span>mergeAdjacent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::mergeAdjacent </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Speculatively merge Varnodes that are input/output to the same p-code op. </p>
<p>If a single p-code op has an input and output <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> that share the same data-type, attempt to merge them. Each merge is speculative and is skipped if it would introduce <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersections. </p>

</div>
</div>
<a id="a319ac2d65a6dff86cbfda772d047b2e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a319ac2d65a6dff86cbfda772d047b2e1">&#9670;&nbsp;</a></span>mergeByDatatype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::mergeByDatatype </td>
          <td>(</td>
          <td class="paramtype">VarnodeLocSet::const_iterator&#160;</td>
          <td class="paramname"><em>startiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VarnodeLocSet::const_iterator&#160;</td>
          <td class="paramname"><em>enditer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to merge all HighVariables in the given range that have the same data-type. </p>
<p>HighVariables that have an instance within the given <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> range are sorted into groups based on their data-type. Then an attempt is made to merge all the HighVariables within a group. If a particular merge causes <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersection, it is skipped. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">startiter</td><td>is the start of the given range of Varnodes </td></tr>
    <tr><td class="paramname">enditer</td><td>is the end of the given range </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aedcf63d8d5400410d06ef4aa250275a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedcf63d8d5400410d06ef4aa250275a1">&#9670;&nbsp;</a></span>mergeMarker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::mergeMarker </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force the merge of input and output Varnodes to MULTIEQUAL and INDIRECT ops. </p>
<p>Run through all MULTIEQUAL and INDIRECT ops in the function. Force the merge of each input <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> with the output <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a>, doing data-flow modification if necessary to resolve <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersections. </p>

</div>
</div>
<a id="ab07666baf4d4fb03ee2243d22f15c25d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07666baf4d4fb03ee2243d22f15c25d">&#9670;&nbsp;</a></span>mergeMultiEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::mergeMultiEntry </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classMerge.html" title="Class for merging low-level Varnodes into high-level HighVariables. ">Merge</a> together Varnodes mapped to SymbolEntrys from the same <a class="el" href="classSymbol.html" title="The base class for a symbol in a symbol table or scope. ">Symbol</a>. </p>
<p>Symbols that have more than one <a class="el" href="classSymbolEntry.html" title="A storage location for a particular Symbol. ">SymbolEntry</a> may attach to more than one <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a>. These Varnodes need to be merged to properly represent a single variable. </p>

</div>
</div>
<a id="a55762a93af96a7e8abab70b169302b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55762a93af96a7e8abab70b169302b59">&#9670;&nbsp;</a></span>mergeOpcode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::mergeOpcode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7">OpCode</a>&#160;</td>
          <td class="paramname"><em>opc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to force merges of input to output for all p-code ops of a given type. </p>
<p>For a given opcode, run through all ops in the function in block/address order and try to merge each input <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> with the output <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a>. If this would introduce <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersections, the merge is skipped. This is generally used to try to merge the input and output of COPY ops if possible. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opc</td><td>is the op-code type to merge </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace3433895878fb4851a8e06899b87f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace3433895878fb4851a8e06899b87f41">&#9670;&nbsp;</a></span>mergeTest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Merge::mergeTest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classHighVariable.html">HighVariable</a> *&#160;</td>
          <td class="paramname"><em>high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classHighVariable.html">HighVariable</a> *&gt; &amp;&#160;</td>
          <td class="paramname"><em>tmplist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test for intersections between a given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> and a list of other HighVariables. </p>
<p>If there is any <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> intersection between the given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> and one in the list, this routine returns <b>false</b>. Otherwise, the given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> is added to the end of the list and <b>true</b> is returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">high</td><td>is the given <a class="el" href="classHighVariable.html" title="A high-level variable modeled as a list of low-level variables, each written once. ">HighVariable</a> </td></tr>
    <tr><td class="paramname">tmplist</td><td>is the list of HighVariables to test against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if there are no pairwise intersections. </dd></dl>

</div>
</div>
<a id="a0af9c332a00eee4f51242239e05bc916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af9c332a00eee4f51242239e05bc916">&#9670;&nbsp;</a></span>processCopyTrims()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Merge::processCopyTrims </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to reduce/eliminate COPYs produced by the merge trimming process. </p>
<p>In order to force merging of certain Varnodes, extra COPY operations may be inserted to reduce their <a class="el" href="classCover.html" title="A description of the topological scope of a single variable object. ">Cover</a> ranges, and multiple COPYs from the same <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> can be created this way. This method collects sets of COPYs generated in this way that have the same input <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> and then tries to replace the COPYs with fewer or a single COPY. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="merge_8hh_source.html">merge.hh</a></li>
<li>merge.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
