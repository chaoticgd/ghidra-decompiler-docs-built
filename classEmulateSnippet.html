<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: EmulateSnippet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classEmulateSnippet-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">EmulateSnippet Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classEmulate.html" title="A pcode-based emulator interface. ">Emulate</a> a <em>snippet</em> of PcodeOps out of a functional context.  
 <a href="classEmulateSnippet.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="emulateutil_8hh_source.html">emulateutil.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for EmulateSnippet:</div>
<div class="dyncontent">
<div class="center"><img src="classEmulateSnippet__inherit__graph.png" border="0" usemap="#EmulateSnippet_inherit__map" alt="Inheritance graph"/></div>
<map name="EmulateSnippet_inherit__map" id="EmulateSnippet_inherit__map">
<area shape="rect" id="node2" href="classEmulate.html" title="A pcode&#45;based emulator interface. " alt="" coords="27,5,98,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for EmulateSnippet:</div>
<div class="dyncontent">
<div class="center"><img src="classEmulateSnippet__coll__graph.png" border="0" usemap="#EmulateSnippet_coll__map" alt="Collaboration graph"/></div>
<map name="EmulateSnippet_coll__map" id="EmulateSnippet_coll__map">
<area shape="rect" id="node2" href="classEmulate.html" title="A pcode&#45;based emulator interface. " alt="" coords="27,95,98,121"/>
<area shape="rect" id="node3" href="classOpBehavior.html" title="Class encapsulating the action/behavior of specific pcode opcodes. " alt="" coords="17,5,108,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad9f38ff5be18035f04b0ced7451ab0d4"><td class="memItemLeft" align="right" valign="top"><a id="ad9f38ff5be18035f04b0ced7451ab0d4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ad9f38ff5be18035f04b0ced7451ab0d4">EmulateSnippet</a> (<a class="el" href="classArchitecture.html">Architecture</a> *g)</td></tr>
<tr class="memdesc:ad9f38ff5be18035f04b0ced7451ab0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classConstructor.html">Constructor</a>. <br /></td></tr>
<tr class="separator:ad9f38ff5be18035f04b0ced7451ab0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af333890e0d9a94efbd3557070a829a44"><td class="memItemLeft" align="right" valign="top"><a id="af333890e0d9a94efbd3557070a829a44"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#af333890e0d9a94efbd3557070a829a44">~EmulateSnippet</a> (void)</td></tr>
<tr class="memdesc:af333890e0d9a94efbd3557070a829a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:af333890e0d9a94efbd3557070a829a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a13101a25f73f33a9b10f20ebf018a"><td class="memItemLeft" align="right" valign="top"><a id="a22a13101a25f73f33a9b10f20ebf018a"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a22a13101a25f73f33a9b10f20ebf018a">setExecuteAddress</a> (const <a class="el" href="classAddress.html">Address</a> &amp;addr)</td></tr>
<tr class="memdesc:a22a13101a25f73f33a9b10f20ebf018a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the address of the next instruction to emulate. <br /></td></tr>
<tr class="separator:a22a13101a25f73f33a9b10f20ebf018a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef11e510794c009453333e847acc38e9"><td class="memItemLeft" align="right" valign="top"><a id="aef11e510794c009453333e847acc38e9"></a>
virtual <a class="el" href="classAddress.html">Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#aef11e510794c009453333e847acc38e9">getExecuteAddress</a> (void) const</td></tr>
<tr class="memdesc:aef11e510794c009453333e847acc38e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the address of the current instruction being executed. <br /></td></tr>
<tr class="separator:aef11e510794c009453333e847acc38e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17efc692edeba1967afa4ff66f42fc5f"><td class="memItemLeft" align="right" valign="top"><a id="a17efc692edeba1967afa4ff66f42fc5f"></a>
<a class="el" href="classArchitecture.html">Architecture</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a17efc692edeba1967afa4ff66f42fc5f">getArch</a> (void) const</td></tr>
<tr class="memdesc:a17efc692edeba1967afa4ff66f42fc5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the underlying <a class="el" href="classArchitecture.html" title="Manager for all the major decompiler subsystems. ">Architecture</a>. <br /></td></tr>
<tr class="separator:a17efc692edeba1967afa4ff66f42fc5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243812d9450f7d70610e23924def533f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a243812d9450f7d70610e23924def533f">resetMemory</a> (void)</td></tr>
<tr class="memdesc:a243812d9450f7d70610e23924def533f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the emulation snippet.  <a href="#a243812d9450f7d70610e23924def533f">More...</a><br /></td></tr>
<tr class="separator:a243812d9450f7d70610e23924def533f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54461be75e3dde108fefcb6a661ea28c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPcodeEmit.html">PcodeEmit</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a54461be75e3dde108fefcb6a661ea28c">buildEmitter</a> (const vector&lt; <a class="el" href="classOpBehavior.html">OpBehavior</a> *&gt; &amp;inst, uintb uniqReserve)</td></tr>
<tr class="memdesc:a54461be75e3dde108fefcb6a661ea28c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide the caller with an emitter for building the p-code snippet.  <a href="#a54461be75e3dde108fefcb6a661ea28c">More...</a><br /></td></tr>
<tr class="separator:a54461be75e3dde108fefcb6a661ea28c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83f137b630e90877b05ea13f8d1d1be"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ad83f137b630e90877b05ea13f8d1d1be">checkForLegalCode</a> (void) const</td></tr>
<tr class="memdesc:ad83f137b630e90877b05ea13f8d1d1be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for p-code that is deemed illegal for a <em>snippet</em>.  <a href="#ad83f137b630e90877b05ea13f8d1d1be">More...</a><br /></td></tr>
<tr class="separator:ad83f137b630e90877b05ea13f8d1d1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace37ff31a80e1f296221195eeec4a4fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#ace37ff31a80e1f296221195eeec4a4fb">setCurrentOp</a> (int4 i)</td></tr>
<tr class="memdesc:ace37ff31a80e1f296221195eeec4a4fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the current executing p-code op by index.  <a href="#ace37ff31a80e1f296221195eeec4a4fb">More...</a><br /></td></tr>
<tr class="separator:ace37ff31a80e1f296221195eeec4a4fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4c1bf018f8ab3c0cea77fa927f5968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#abc4c1bf018f8ab3c0cea77fa927f5968">setVarnodeValue</a> (uintb offset, uintb val)</td></tr>
<tr class="memdesc:abc4c1bf018f8ab3c0cea77fa927f5968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a temporary register value in the machine state.  <a href="#abc4c1bf018f8ab3c0cea77fa927f5968">More...</a><br /></td></tr>
<tr class="separator:abc4c1bf018f8ab3c0cea77fa927f5968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19946de88e6ea7dbf396648640fdb97"><td class="memItemLeft" align="right" valign="top">uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#af19946de88e6ea7dbf396648640fdb97">getVarnodeValue</a> (<a class="el" href="structVarnodeData.html">VarnodeData</a> *vn) const</td></tr>
<tr class="memdesc:af19946de88e6ea7dbf396648640fdb97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the value of a <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> from the current machine state.  <a href="#af19946de88e6ea7dbf396648640fdb97">More...</a><br /></td></tr>
<tr class="separator:af19946de88e6ea7dbf396648640fdb97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a5c0e4b9085b84e2d487568f9aa484"><td class="memItemLeft" align="right" valign="top">uintb&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulateSnippet.html#a77a5c0e4b9085b84e2d487568f9aa484">getTempValue</a> (uintb offset) const</td></tr>
<tr class="memdesc:a77a5c0e4b9085b84e2d487568f9aa484"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a temporary register value directly.  <a href="#a77a5c0e4b9085b84e2d487568f9aa484">More...</a><br /></td></tr>
<tr class="separator:a77a5c0e4b9085b84e2d487568f9aa484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classEmulate"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classEmulate')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classEmulate.html">Emulate</a></td></tr>
<tr class="memitem:a4a919329a32fae8f2f79fce47f258820 inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top"><a id="a4a919329a32fae8f2f79fce47f258820"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a4a919329a32fae8f2f79fce47f258820">Emulate</a> (void)</td></tr>
<tr class="memdesc:a4a919329a32fae8f2f79fce47f258820 inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">generic emulator constructor <br /></td></tr>
<tr class="separator:a4a919329a32fae8f2f79fce47f258820 inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4858bc80cf7b078a592f9c8d3442450d inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a4858bc80cf7b078a592f9c8d3442450d">setHalt</a> (bool val)</td></tr>
<tr class="memdesc:a4858bc80cf7b078a592f9c8d3442450d inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the <em>halt</em> state of the emulator.  <a href="classEmulate.html#a4858bc80cf7b078a592f9c8d3442450d">More...</a><br /></td></tr>
<tr class="separator:a4858bc80cf7b078a592f9c8d3442450d inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f2882dd3554c18c60e817e80f3c4bc inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#ab1f2882dd3554c18c60e817e80f3c4bc">getHalt</a> (void) const</td></tr>
<tr class="memdesc:ab1f2882dd3554c18c60e817e80f3c4bc inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <em>halt</em> state of the emulator.  <a href="classEmulate.html#ab1f2882dd3554c18c60e817e80f3c4bc">More...</a><br /></td></tr>
<tr class="separator:ab1f2882dd3554c18c60e817e80f3c4bc inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad37ba97a90d7cd5338a75afce3a21b9 inherit pub_methods_classEmulate"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#aad37ba97a90d7cd5338a75afce3a21b9">executeCurrentOp</a> (void)</td></tr>
<tr class="memdesc:aad37ba97a90d7cd5338a75afce3a21b9 inherit pub_methods_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do a single pcode op step.  <a href="classEmulate.html#aad37ba97a90d7cd5338a75afce3a21b9">More...</a><br /></td></tr>
<tr class="separator:aad37ba97a90d7cd5338a75afce3a21b9 inherit pub_methods_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classEmulate"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classEmulate')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classEmulate.html">Emulate</a></td></tr>
<tr class="memitem:a8811816cbc0eef9f4cdb856cfd496e94 inherit pro_attribs_classEmulate"><td class="memItemLeft" align="right" valign="top"><a id="a8811816cbc0eef9f4cdb856cfd496e94"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a8811816cbc0eef9f4cdb856cfd496e94">emu_halted</a></td></tr>
<tr class="memdesc:a8811816cbc0eef9f4cdb856cfd496e94 inherit pro_attribs_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to <b>true</b> if the emulator is halted. <br /></td></tr>
<tr class="separator:a8811816cbc0eef9f4cdb856cfd496e94 inherit pro_attribs_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e5d4f8c0ad5c62aa3e723440c5141ca inherit pro_attribs_classEmulate"><td class="memItemLeft" align="right" valign="top"><a id="a1e5d4f8c0ad5c62aa3e723440c5141ca"></a>
<a class="el" href="classOpBehavior.html">OpBehavior</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEmulate.html#a1e5d4f8c0ad5c62aa3e723440c5141ca">currentBehave</a></td></tr>
<tr class="memdesc:a1e5d4f8c0ad5c62aa3e723440c5141ca inherit pro_attribs_classEmulate"><td class="mdescLeft">&#160;</td><td class="mdescRight">Behavior of the next op to execute. <br /></td></tr>
<tr class="separator:a1e5d4f8c0ad5c62aa3e723440c5141ca inherit pro_attribs_classEmulate"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classEmulate.html" title="A pcode-based emulator interface. ">Emulate</a> a <em>snippet</em> of PcodeOps out of a functional context. </p>
<p>Emulation is performed on a short sequence (<b>snippet</b>) of <a class="el" href="classPcodeOpRaw.html" title="A low-level representation of a single pcode operation. ">PcodeOpRaw</a> objects. Control-flow emulation is limited to this snippet; BRANCH and CBRANCH operations can happen using p-code relative branching. Executing BRANCHIND, CALL, CALLIND, CALLOTHER, STORE, MULTIEQUAL, INDIRECT, SEGMENTOP, CPOOLOP, and NEW ops is treated as illegal and an exception is thrown. Expressions can only use temporary registers or read from the <a class="el" href="classLoadImage.html" title="An interface into a particular binary executable image. ">LoadImage</a>.</p>
<p>The set of <a class="el" href="classPcodeOpRaw.html" title="A low-level representation of a single pcode operation. ">PcodeOpRaw</a> objects in the snippet is provided by emitting p-code to the object returned by <a class="el" href="classEmulateSnippet.html#a54461be75e3dde108fefcb6a661ea28c" title="Provide the caller with an emitter for building the p-code snippet. ">buildEmitter()</a>. This is designed for one-time initialization of this class, which can be repeatedly used by calling <a class="el" href="classEmulateSnippet.html#a243812d9450f7d70610e23924def533f" title="Reset the emulation snippet. ">resetMemory()</a> between executions. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a54461be75e3dde108fefcb6a661ea28c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54461be75e3dde108fefcb6a661ea28c">&#9670;&nbsp;</a></span>buildEmitter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPcodeEmit.html">PcodeEmit</a> * EmulateSnippet::buildEmitter </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; <a class="el" href="classOpBehavior.html">OpBehavior</a> *&gt; &amp;&#160;</td>
          <td class="paramname"><em>inst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>uniqReserve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide the caller with an emitter for building the p-code snippet. </p>
<p>Any p-code produced by the <a class="el" href="classPcodeEmit.html" title="Abstract class for emitting pcode to an application. ">PcodeEmit</a>, when triggered by the caller, becomes part of the <em>snippet</em> that will get emulated by <b>this</b>. The caller should free the <a class="el" href="classPcodeEmit.html" title="Abstract class for emitting pcode to an application. ">PcodeEmit</a> object immediately after use. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inst</td><td>is the <em>opcode</em> to <em>behavior</em> map the emitter will use </td></tr>
    <tr><td class="paramname">uniqReserve</td><td>is the starting offset within the <em>unique</em> address space for any temporary registers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the newly constructed emitter </dd></dl>

</div>
</div>
<a id="ad83f137b630e90877b05ea13f8d1d1be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83f137b630e90877b05ea13f8d1d1be">&#9670;&nbsp;</a></span>checkForLegalCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EmulateSnippet::checkForLegalCode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for p-code that is deemed illegal for a <em>snippet</em>. </p>
<p>This method facilitates enforcement of the formal rules for snippet code.</p><ul>
<li>Branches must use p-code relative addressing.</li>
<li>Snippets can only read/write from temporary registers</li>
<li>Snippets cannot use BRANCHIND, CALL, CALLIND, CALLOTHER, STORE, SEGMENTOP, CPOOLREF, NEW, MULTIEQUAL, or INDIRECT</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if the current snippet is legal </dd></dl>

</div>
</div>
<a id="a77a5c0e4b9085b84e2d487568f9aa484"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a5c0e4b9085b84e2d487568f9aa484">&#9670;&nbsp;</a></span>getTempValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintb EmulateSnippet::getTempValue </td>
          <td>(</td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a temporary register value directly. </p>
<p>This allows the user to obtain the final value of the snippet calculation, without having to have the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> object in hand. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>is the offset of the temporary register to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the calculated value or 0 if the register was never written </dd></dl>

</div>
</div>
<a id="af19946de88e6ea7dbf396648640fdb97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19946de88e6ea7dbf396648640fdb97">&#9670;&nbsp;</a></span>getVarnodeValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintb EmulateSnippet::getVarnodeValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVarnodeData.html">VarnodeData</a> *&#160;</td>
          <td class="paramname"><em>vn</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the value of a <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> from the current machine state. </p>
<p>If the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> is a temporary registers, the storage offset is used to look up the value from the machine state cache. If the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> represents a RAM location, the value is pulled directly out of the load-image. If the value does not exist, a "Read before write" exception is thrown. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vn</td><td>is the <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a> to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the retrieved value </dd></dl>

</div>
</div>
<a id="a243812d9450f7d70610e23924def533f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243812d9450f7d70610e23924def533f">&#9670;&nbsp;</a></span>resetMemory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::resetMemory </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset the emulation snippet. </p>
<p>Reset the memory state, and set the first p-code op as current. </p>

</div>
</div>
<a id="ace37ff31a80e1f296221195eeec4a4fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace37ff31a80e1f296221195eeec4a4fb">&#9670;&nbsp;</a></span>setCurrentOp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::setCurrentOp </td>
          <td>(</td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the current executing p-code op by index. </p>
<p>The i-th p-code op in the snippet sequence is set as the currently executing op. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>is the index </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc4c1bf018f8ab3c0cea77fa927f5968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc4c1bf018f8ab3c0cea77fa927f5968">&#9670;&nbsp;</a></span>setVarnodeValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EmulateSnippet::setVarnodeValue </td>
          <td>(</td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintb&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a temporary register value in the machine state. </p>
<p>The temporary <a class="el" href="classVarnode.html" title="A low-level variable or contiguous set of bytes described by an Address and a size. ">Varnode</a>'s storage offset is used as key into the machine state map. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>is the temporary storage offset </td></tr>
    <tr><td class="paramname">val</td><td>is the value to put into the machine state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="emulateutil_8hh_source.html">emulateutil.hh</a></li>
<li>emulateutil.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
